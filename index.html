<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NWADRI - Essayez vos lunettes en AR</title>
    
    <style>
        /* RESET */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: #0a0a0a;
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* HEADER */
        header {
            text-align: center;
            padding: 30px 20px;
            margin-bottom: 30px;
        }
        
        .logo {
            font-size: 3.5rem;
            font-weight: 900;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #00c6ff, #0072ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.8;
            margin-bottom: 30px;
        }
        
        /* BOUTONS */
        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }
        
        .btn {
            padding: 12px 25px;
            background: linear-gradient(45deg, #00c6ff, #0072ff);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 198, 255, 0.4);
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn-red {
            background: linear-gradient(45deg, #ff416c, #ff4b2b);
        }
        
        .btn-green {
            background: linear-gradient(45deg, #56ab2f, #a8e063);
        }
        
        /* ZONE AR */
        .ar-container {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            position: relative;
        }
        
        #ar-canvas {
            width: 100%;
            height: 500px;
            background: #000;
            border-radius: 10px;
            display: block;
        }
        
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            background: rgba(0,0,0,0.9);
            padding: 30px;
            border-radius: 10px;
            border: 2px solid #00c6ff;
        }
        
        .loading i {
            font-size: 2.5rem;
            color: #00c6ff;
            margin-bottom: 15px;
            display: block;
        }
        
        /* MOD√àLES */
        .models {
            background: rgba(255,255,255,0.05);
            padding: 25px;
            border-radius: 15px;
            margin-top: 30px;
        }
        
        .model-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .model-card {
            background: rgba(255,255,255,0.1);
            border: 2px solid transparent;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .model-card:hover {
            background: rgba(255,255,255,0.15);
            transform: translateY(-5px);
        }
        
        .model-card.active {
            border-color: #00c6ff;
            background: rgba(0, 198, 255, 0.1);
        }
        
        .model-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: #00c6ff;
        }
        
        .model-name {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        /* MESSAGES */
        .message {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 25px;
            background: #00c6ff;
            color: white;
            border-radius: 8px;
            z-index: 1000;
            animation: slideIn 0.3s ease;
            max-width: 300px;
        }
        
        .message.error {
            background: #ff416c;
        }
        
        .message.success {
            background: #56ab2f;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* RESPONSIVE */
        @media (max-width: 768px) {
            .logo { font-size: 2.5rem; }
            #ar-canvas { height: 400px; }
            .model-grid { grid-template-columns: repeat(2, 1fr); }
        }
        
        @media (max-width: 480px) {
            .model-grid { grid-template-columns: 1fr; }
            #ar-canvas { height: 350px; }
        }
    </style>
    
    <!-- Three.js -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/GLTFLoader.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <header>
            <h1 class="logo">NWADRI</h1>
            <p class="subtitle">Essayez vos lunettes de soleil en r√©alit√© augment√©e</p>
            
            <div class="controls">
                <button id="startCamera" class="btn">
                    <i class="fas fa-camera"></i> Activer Cam√©ra
                </button>
                <button id="startAR" class="btn btn-green" disabled>
                    <i class="fas fa-vr-cardboard"></i> Afficher Lunettes
                </button>
                <button id="stopAR" class="btn btn-red" disabled>
                    <i class="fas fa-stop"></i> Cacher Lunettes
                </button>
            </div>
        </header>
        
        <!-- ZONE AR -->
        <div class="ar-container">
            <canvas id="ar-canvas"></canvas>
            
            <div id="loading" class="loading" style="display: none;">
                <i class="fas fa-spinner fa-spin"></i>
                <p>Chargement...</p>
            </div>
        </div>
        
        <!-- MOD√àLES -->
        <div class="models">
            <h2 style="text-align: center; margin-bottom: 20px;">
                <i class="fas fa-sunglasses"></i> Nos Mod√®les
            </h2>
            
            <div class="model-grid">
                <div class="model-card active" data-model="1">
                    <div class="model-icon">
                        <i class="fas fa-glasses"></i>
                    </div>
                    <div class="model-name">Classic Black</div>
                    <div style="color: #00c6ff; font-weight: 600;">‚Ç¨129</div>
                </div>
                
                <div class="model-card" data-model="2">
                    <div class="model-icon">
                        <i class="fas fa-sun"></i>
                    </div>
                    <div class="model-name">Golden Style</div>
                    <div style="color: #00c6ff; font-weight: 600;">‚Ç¨159</div>
                </div>
                
                <div class="model-card" data-model="3">
                    <div class="model-icon">
                        <i class="fas fa-gem"></i>
                    </div>
                    <div class="model-name">Premium Silver</div>
                    <div style="color: #00c6ff; font-weight: 600;">‚Ç¨179</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- APP JS -->
    <script>
// ============================================================
// NWADRI AR - APPLICATION COMPL√àTE
// ============================================================

class NwadriAR {
    constructor() {
        // √âl√©ments DOM
        this.canvas = document.getElementById('ar-canvas');
        this.loading = document.getElementById('loading');
        
        // ============================================================
        // ICI : METTEZ VOS URLs .glb
        // ============================================================
        this.models = {
            '1': {
                name: 'Classic Black',
                price: '‚Ç¨129',
                // ‚Üì‚Üì‚Üì REMPLACEZ CE LIEN PAR VOTRE FICHIER .glb ‚Üì‚Üì‚Üì
                glbUrl: 'models/sunglasses.glb',
                // Param√®tres de position (√† ajuster selon votre mod√®le)
                scale: 0.15,           // Taille : augmentez si trop petit
                positionY: -0.05,      // Position verticale : + = plus haut, - = plus bas
                positionZ: -0.4,       // Distance : + = plus loin, - = plus pr√®s
                rotationY: Math.PI     // Rotation pour cam√©ra frontale
            },
            '2': {
                name: 'Golden Style',
                price: '‚Ç¨159',
                // ‚Üì‚Üì‚Üì REMPLACEZ CE LIEN PAR VOTRE FICHIER .glb ‚Üì‚Üì‚Üì
                glbUrl: 'models/sunglasses2.glb',
                scale: 0.15,
                positionY: -0.05,
                positionZ: -0.4,
                rotationY: Math.PI
            },
            '3': {
                name: 'Premium Silver',
                price: '‚Ç¨179',
                // ‚Üì‚Üì‚Üì REMPLACEZ CE LIEN PAR VOTRE FICHIER .glb ‚Üì‚Üì‚Üì
                glbUrl: 'models/sunglasses3.glb',
                scale: 0.15,
                positionY: -0.05,
                positionZ: -0.4,
                rotationY: Math.PI
            }
        };
        // ============================================================
        // FIN DES URLs .glb
        // ============================================================
        
        // √âtat
        this.isCameraActive = false;
        this.isARActive = false;
        this.currentModel = '1';
        this.video = null;
        
        // Three.js
        this.scene = null;
        this.camera = null;
        this.renderer = null;
        this.currentGlasses = null;
        this.videoTexture = null;
        
        // Initialisation
        this.init();
    }
    
    // ==================== INITIALISATION ====================
    init() {
        console.log('üöÄ NWADRI AR - Initialisation');
        
        // Taille canvas
        this.canvas.width = this.canvas.clientWidth;
        this.canvas.height = this.canvas.clientHeight;
        
        // √âv√©nements
        this.setupEventListeners();
        
        console.log('‚úÖ Pr√™t !');
    }
    
    // ==================== CAM√âRA ====================
    async startCamera() {
        try {
            this.showLoading('Acc√®s √† la cam√©ra...');
            
            // Cr√©er √©l√©ment vid√©o
            this.video = document.createElement('video');
            this.video.playsInline = true;
            this.video.muted = true;
            this.video.style.display = 'none';
            document.body.appendChild(this.video);
            
            // Acc√©der √† la cam√©ra
            const stream = await navigator.mediaDevices.getUserMedia({
                video: {
                    facingMode: 'user', // Cam√©ra frontale
                    width: { ideal: 640 },
                    height: { ideal: 480 }
                }
            });
            
            this.video.srcObject = stream;
            await this.video.play();
            
            // Initialiser Three.js avec la vid√©o
            this.initThreeJS();
            
            this.isCameraActive = true;
            this.updateUI();
            this.hideLoading();
            this.showMessage('‚úÖ Cam√©ra activ√©e', 'success');
            
        } catch (error) {
            console.error('Erreur cam√©ra:', error);
            this.hideLoading();
            this.showMessage('‚ùå Erreur cam√©ra: ' + error.message, 'error');
        }
    }
    
    // ==================== THREE.JS ====================
    initThreeJS() {
        // Sc√®ne
        this.scene = new THREE.Scene();
        
        // Cam√©ra Three.js (pas la webcam)
        const aspect = this.canvas.clientWidth / this.canvas.clientHeight;
        this.camera = new THREE.PerspectiveCamera(60, aspect, 0.1, 1000);
        this.camera.position.z = 5;
        
        // Renderer
        this.renderer = new THREE.WebGLRenderer({
            canvas: this.canvas,
            alpha: true,
            antialias: true
        });
        this.renderer.setSize(this.canvas.clientWidth, this.canvas.clientHeight);
        this.renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        
        // Cr√©er la texture vid√©o
        this.createVideoBackground();
        
        // Lumi√®res
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.8);
        this.scene.add(ambientLight);
        
        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5);
        directionalLight.position.set(5, 5, 5);
        this.scene.add(directionalLight);
    }
    
    createVideoBackground() {
        // Cr√©er une texture √† partir de la vid√©o
        this.videoTexture = new THREE.VideoTexture(this.video);
        this.videoTexture.minFilter = THREE.LinearFilter;
        this.videoTexture.magFilter = THREE.LinearFilter;
        this.videoTexture.format = THREE.RGBAFormat;
        
        // Cr√©er un plan pour afficher la vid√©o
        const geometry = new THREE.PlaneGeometry(10, 7.5);
        const material = new THREE.MeshBasicMaterial({
            map: this.videoTexture,
            transparent: true,
            opacity: 1.0
        });
        
        const plane = new THREE.Mesh(geometry, material);
        plane.position.z = -5;
        this.scene.add(plane);
    }
    
    // ==================== CHARGEMENT .glb ====================
    async loadGlasses(modelId) {
        const modelInfo = this.models[modelId];
        
        try {
            console.log('Chargement:', modelInfo.glbUrl);
            
            // Charger le mod√®le .glb
            const loader = new THREE.GLTFLoader();
            
            const gltf = await new Promise((resolve, reject) => {
                loader.load(
                    modelInfo.glbUrl,
                    (gltf) => {
                        console.log('‚úÖ Mod√®le charg√©');
                        resolve(gltf);
                    },
                    (progress) => {
                        const percent = (progress.loaded / progress.total * 100).toFixed(1);
                        console.log(`Chargement: ${percent}%`);
                    },
                    (error) => {
                        console.error('Erreur chargement:', error);
                        reject(error);
                    }
                );
            });
            
            const model = gltf.scene;
            
            // ============================================================
            // POSITIONNEMENT SUR LE VISAGE
            // ============================================================
            
            // Position sur le visage (valeurs calibr√©es)
            model.position.set(
                0,                    // Centre horizontal
                modelInfo.positionY,  // Position verticale (niveau des yeux)
                modelInfo.positionZ   // Distance par rapport √† la cam√©ra
            );
            
            // Taille
            model.scale.set(
                modelInfo.scale,
                modelInfo.scale,
                modelInfo.scale
            );
            
            // Rotation pour cam√©ra frontale
            model.rotation.set(
                0,
                modelInfo.rotationY,  // Rotation de 180¬∞ pour effet miroir
                0
            );
            
            // Optimiser le mod√®le
            this.optimizeModel(model);
            
            return model;
            
        } catch (error) {
            console.error('Erreur chargement, cr√©ation fallback...');
            
            // Cr√©er des lunettes de secours
            return this.createFallbackGlasses(modelInfo);
        }
    }
    
    optimizeModel(model) {
        model.traverse((child) => {
            if (child.isMesh) {
                // Rendre double face
                child.material.side = THREE.DoubleSide;
                
                // Pour les verres
                if (child.name.toLowerCase().includes('glass') || 
                    child.name.toLowerCase().includes('lens')) {
                    child.material.transparent = true;
                    child.material.opacity = 0.6;
                }
            }
        });
    }
    
    createFallbackGlasses(modelInfo) {
        console.log('Cr√©ation lunettes de secours');
        
        const group = new THREE.Group();
        
        // Mat√©riaux
        const frameMaterial = new THREE.MeshStandardMaterial({
            color: 0x000000,
            metalness: 0.8,
            roughness: 0.2
        });
        
        const lensMaterial = new THREE.MeshPhysicalMaterial({
            color: 0x1a5276,
            transmission: 0.7,
            roughness: 0.1,
            transparent: true,
            opacity: 0.4
        });
        
        // Cadres
        const leftFrame = new THREE.Mesh(
            new THREE.TorusGeometry(0.4, 0.04, 16, 100),
            frameMaterial
        );
        leftFrame.position.x = -0.45;
        
        const rightFrame = new THREE.Mesh(
            new THREE.TorusGeometry(0.4, 0.04, 16, 100),
            frameMaterial
        );
        rightFrame.position.x = 0.45;
        
        // Verres
        const leftLens = new THREE.Mesh(
            new THREE.CircleGeometry(0.35, 32),
            lensMaterial
        );
        leftLens.position.x = -0.45;
        leftLens.position.z = 0.02;
        
        const rightLens = new THREE.Mesh(
            new THREE.CircleGeometry(0.35, 32),
            lensMaterial
        );
        rightLens.position.x = 0.45;
        rightLens.position.z = 0.02;
        
        // Pont
        const bridge = new THREE.Mesh(
            new THREE.BoxGeometry(0.3, 0.02, 0.02),
            frameMaterial
        );
        
        // Ajouter au groupe
        group.add(leftFrame, rightFrame, leftLens, rightLens, bridge);
        
        // Positionner sur le visage
        group.position.set(0, modelInfo.positionY, modelInfo.positionZ);
        group.scale.set(modelInfo.scale, modelInfo.scale, modelInfo.scale);
        group.rotation.y = modelInfo.rotationY;
        
        return group;
    }
    
    // ==================== AFFICHER LUNETTES ====================
    async startAR() {
        if (!this.isCameraActive) {
            this.showMessage('Activez d\'abord la cam√©ra', 'error');
            return;
        }
        
        try {
            this.showLoading('Positionnement des lunettes...');
            
            // Charger les lunettes
            this.currentGlasses = await this.loadGlasses(this.currentModel);
            
            // Ajouter √† la sc√®ne
            this.scene.add(this.currentGlasses);
            
            // D√©marrer l'animation
            this.isARActive = true;
            this.startAnimation();
            
            this.hideLoading();
            this.showMessage('‚ú® Lunettes affich√©es sur votre visage', 'success');
            this.updateUI();
            
            // Afficher les contr√¥les d'ajustement
            this.showAdjustControls();
            
        } catch (error) {
            console.error('Erreur AR:', error);
            this.hideLoading();
            this.showMessage('Erreur affichage lunettes', 'error');
        }
    }
    
    stopAR() {
        this.isARActive = false;
        
        // Retirer les lunettes
        if (this.currentGlasses && this.scene) {
            this.scene.remove(this.currentGlasses);
            this.currentGlasses = null;
        }
        
        this.updateUI();
        this.hideAdjustControls();
    }
    
    // ==================== ANIMATION ====================
    startAnimation() {
        const animate = () => {
            if (!this.isARActive) return;
            
            requestAnimationFrame(animate);
            
            // Mettre √† jour la texture vid√©o
            if (this.videoTexture) {
                this.videoTexture.needsUpdate = true;
            }
            
            // Animation l√©g√®re des lunettes
            if (this.currentGlasses) {
                // Suivi subtil du "visage"
                const time = Date.now() * 0.001;
                this.currentGlasses.position.y = this.models[this.currentModel].positionY + Math.sin(time) * 0.01;
            }
            
            // Rendu
            if (this.renderer && this.scene && this.camera) {
                this.renderer.render(this.scene, this.camera);
            }
        };
        
        animate();
    }
    
    // ==================== CHANGER DE MOD√àLE ====================
    async switchModel(modelId) {
        if (!this.isARActive) {
            this.currentModel = modelId;
            return;
        }
        
        try {
            // Retirer les anciennes lunettes
            if (this.currentGlasses && this.scene) {
                this.scene.remove(this.currentGlasses);
            }
            
            // Charger les nouvelles
            this.currentModel = modelId;
            this.currentGlasses = await this.loadGlasses(modelId);
            
            // Ajouter √† la sc√®ne
            this.scene.add(this.currentGlasses);
            
            this.showMessage(`üëì ${this.models[modelId].name}`, 'info');
            
        } catch (error) {
            console.error('Erreur changement mod√®le:', error);
        }
    }
    
    // ==================== CONTR√îLES D'AJUSTEMENT ====================
    showAdjustControls() {
        const controls = `
            <div id="adjust-controls" style="
                position: absolute;
                bottom: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: rgba(0,0,0,0.8);
                padding: 15px;
                border-radius: 10px;
                display: grid;
                grid-template-columns: repeat(3, 1fr);
                gap: 10px;
                z-index: 100;
            ">
                <button class="adj-btn" data-action="up" title="Monter">
                    <i class="fas fa-arrow-up"></i>
                </button>
                <button class="adj-btn" data-action="down" title="Descendre">
                    <i class="fas fa-arrow-down"></i>
                </button>
                <button class="adj-btn" data-action="reset" title="R√©initialiser">
                    <i class="fas fa-redo"></i>
                </button>
                <button class="adj-btn" data-action="left" title="Gauche">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <button class="adj-btn" data-action="right" title="Droite">
                    <i class="fas fa-arrow-right"></i>
                </button>
                <button class="adj-btn" data-action="bigger" title="Agrandir">
                    <i class="fas fa-search-plus"></i>
                </button>
            </div>
        `;
        
        const style = document.createElement('style');
        style.textContent = `
            .adj-btn {
                width: 40px;
                height: 40px;
                border-radius: 50%;
                border: none;
                background: #00c6ff;
                color: white;
                font-size: 1rem;
                cursor: pointer;
                transition: all 0.2s;
            }
            .adj-btn:hover {
                background: #0072ff;
                transform: scale(1.1);
            }
        `;
        
        document.head.appendChild(style);
        document.querySelector('.ar-container').insertAdjacentHTML('beforeend', controls);
        
        // √âv√©nements
        document.querySelectorAll('.adj-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const action = e.currentTarget.dataset.action;
                this.adjustGlasses(action);
            });
        });
    }
    
    hideAdjustControls() {
        const controls = document.getElementById('adjust-controls');
        if (controls) controls.remove();
    }
    
    adjustGlasses(action) {
        if (!this.currentGlasses) return;
        
        const modelInfo = this.models[this.currentModel];
        
        switch (action) {
            case 'up':
                this.currentGlasses.position.y += 0.02;
                break;
            case 'down':
                this.currentGlasses.position.y -= 0.02;
                break;
            case 'left':
                this.currentGlasses.position.x -= 0.02;
                break;
            case 'right':
                this.currentGlasses.position.x += 0.02;
                break;
            case 'bigger':
                this.currentGlasses.scale.multiplyScalar(1.1);
                break;
            case 'reset':
                this.currentGlasses.position.set(0, modelInfo.positionY, modelInfo.positionZ);
                this.currentGlasses.scale.set(modelInfo.scale, modelInfo.scale, modelInfo.scale);
                this.currentGlasses.rotation.set(0, modelInfo.rotationY, 0);
                break;
        }
    }
    
    // ==================== UI ====================
    setupEventListeners() {
        // Activer Cam√©ra
        document.getElementById('startCamera').addEventListener('click', () => {
            this.startCamera();
        });
        
        // Afficher Lunettes
        document.getElementById('startAR').addEventListener('click', () => {
            this.startAR();
        });
        
        // Cacher Lunettes
        document.getElementById('stopAR').addEventListener('click', () => {
            this.stopAR();
        });
        
        // Changer mod√®le
        document.querySelectorAll('.model-card').forEach(card => {
            card.addEventListener('click', () => {
                const modelId = card.dataset.model;
                
                // Mettre √† jour la s√©lection
                document.querySelectorAll('.model-card').forEach(c => {
                    c.classList.remove('active');
                });
                card.classList.add('active');
                
                // Changer de mod√®le
                this.switchModel(modelId);
            });
        });
        
        // Redimensionnement
        window.addEventListener('resize', () => {
            this.onResize();
        });
    }
    
    onResize() {
        this.canvas.width = this.canvas.clientWidth;
        this.canvas.height = this.canvas.clientHeight;
        
        if (this.camera && this.renderer) {
            this.camera.aspect = this.canvas.clientWidth / this.canvas.clientHeight;
            this.camera.updateProjectionMatrix();
            this.renderer.setSize(this.canvas.clientWidth, this.canvas.clientHeight);
        }
    }
    
    updateUI() {
        document.getElementById('startCamera').disabled = this.isCameraActive;
        document.getElementById('startAR').disabled = !this.isCameraActive || this.isARActive;
        document.getElementById('stopAR').disabled = !this.isARActive;
    }
    
    showLoading(text) {
        if (this.loading) {
            this.loading.querySelector('p').textContent = text;
            this.loading.style.display = 'block';
        }
    }
    
    hideLoading() {
        if (this.loading) {
            this.loading.style.display = 'none';
        }
    }
    
    showMessage(text, type = 'info') {
        // Supprimer ancien message
        const old = document.querySelector('.message');
        if (old) old.remove();
        
        // Cr√©er nouveau
        const message = document.createElement('div');
        message.className = `message ${type}`;
        message.innerHTML = `
            <i class="fas fa-${type === 'error' ? 'exclamation-triangle' : 
                              type === 'success' ? 'check-circle' : 'info-circle'}"></i>
            ${text}
        `;
        
        document.body.appendChild(message);
        
        // Auto-suppression
        setTimeout(() => {
            if (message.parentElement) {
                message.remove();
            }
        }, 3000);
    }
    
    // ==================== NETTOYAGE ====================
    cleanup() {
        this.stopAR();
        
        if (this.video && this.video.srcObject) {
            this.video.srcObject.getTracks().forEach(track => track.stop());
        }
        
        if (this.renderer) {
            this.renderer.dispose();
        }
    }
}

// ==================== D√âMARRAGE ====================
document.addEventListener('DOMContentLoaded', () => {
    console.log('üé¨ NWADRI - Chargement...');
    
    // V√©rifier Three.js
    if (typeof THREE === 'undefined') {
        alert('Erreur: Three.js non charg√©. V√©rifiez votre connexion.');
        return;
    }
    
    // Cr√©er l'application
    window.app = new NwadriAR();
    
    // Nettoyage
    window.addEventListener('beforeunload', () => {
        if (window.app) {
            window.app.cleanup();
        }
    });
    
    console.log('‚úÖ NWADRI - Pr√™t !');
    
    // Commandes de d√©bogage
    console.log('üí° Commandes disponibles:');
    console.log('   app.startCamera() - Activer la cam√©ra');
    console.log('   app.startAR() - Afficher les lunettes');
    console.log('   app.switchModel("2") - Changer de mod√®le');
});
    </script>
</body>
</html>
